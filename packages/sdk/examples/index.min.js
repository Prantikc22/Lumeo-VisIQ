"use strict";var visitoriq=(()=>{var _=Object.defineProperty;var F=Object.getOwnPropertyDescriptor;var D=Object.getOwnPropertyNames;var H=Object.prototype.hasOwnProperty;var M=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),K=(e,t)=>{for(var i in t)_(e,i,{get:t[i],enumerable:!0})},Q=(e,t,i,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of D(t))!H.call(e,s)&&s!==i&&_(e,s,{get:()=>t[s],enumerable:!(n=F(t,s))||n.enumerable});return e};var z=e=>Q(_({},"__esModule",{value:!0}),e);var P=M((j,C)=>{"use strict";(function(e,t){typeof define=="function"&&define.amd?define([],t):typeof C<"u"&&C.exports?C.exports=t():e.sha256=t()})(j,function(){var e=function t(i){function n(I,L){return I>>>L|I<<32-L}for(var s=Math.pow,w=s(2,32),l="length",r,c,y="",m=[],b=i[l]*8,o=t.h=t.h||[],k=t.k=t.k||[],S=k[l],A={},g=2;S<64;g++)if(!A[g]){for(r=0;r<313;r+=g)A[r]=g;o[S]=s(g,.5)*w|0,k[S++]=s(g,.3333333333333333)*w|0}for(i+="\x80";i[l]%64-56;)i+="\0";for(r=0;r<i[l];r++){if(c=i.charCodeAt(r),c>>8)return;m[r>>2]|=c<<(3-r)%4*8}for(m[m[l]]=b/w|0,m[m[l]]=b,c=0;c<m[l];){var h=m.slice(c,c+=16),p=o;for(o=o.slice(0,8),r=0;r<64;r++){var O=r+c,T=h[r-15],x=h[r-2],v=o[0],d=o[4],a=o[7]+(n(d,6)^n(d,11)^n(d,25))+(d&o[5]^~d&o[6])+k[r]+(h[r]=r<16?h[r]:h[r-16]+(n(T,7)^n(T,18)^T>>>3)+h[r-7]+(n(x,17)^n(x,19)^x>>>10)|0),u=(n(v,2)^n(v,13)^n(v,22))+(v&o[1]^v&o[2]^o[1]&o[2]);o=[a+u|0].concat(o),o[4]=o[4]+a|0}for(r=0;r<8;r++)o[r]=o[r]+p[r]|0}for(r=0;r<8;r++)for(c=3;c+1;c--){var f=o[r]>>c*8&255;y+=(f<16?0:"")+f.toString(16)}return y};return e.code='var sha256=function a(b){function c(a,b){return a>>>b|a<<32-b}for(var d,e,f=Math.pow,g=f(2,32),h="length",i="",j=[],k=8*b[h],l=a.h=a.h||[],m=a.k=a.k||[],n=m[h],o={},p=2;64>n;p++)if(!o[p]){for(d=0;313>d;d+=p)o[d]=p;l[n]=f(p,.5)*g|0,m[n++]=f(p,1/3)*g|0}for(b+="\\x80";b[h]%64-56;)b+="\\x00";for(d=0;d<b[h];d++){if(e=b.charCodeAt(d),e>>8)return;j[d>>2]|=e<<(3-d)%4*8}for(j[j[h]]=k/g|0,j[j[h]]=k,e=0;e<j[h];){var q=j.slice(e,e+=16),r=l;for(l=l.slice(0,8),d=0;64>d;d++){var s=q[d-15],t=q[d-2],u=l[0],v=l[4],w=l[7]+(c(v,6)^c(v,11)^c(v,25))+(v&l[5]^~v&l[6])+m[d]+(q[d]=16>d?q[d]:q[d-16]+(c(s,7)^c(s,18)^s>>>3)+q[d-7]+(c(t,17)^c(t,19)^t>>>10)|0),x=(c(u,2)^c(u,13)^c(u,22))+(u&l[1]^u&l[2]^l[1]&l[2]);l=[w+x|0].concat(l),l[4]=l[4]+w|0}for(d=0;8>d;d++)l[d]=l[d]+r[d]|0}for(d=0;8>d;d++)for(e=3;e+1;e--){var y=l[d]>>8*e&255;i+=(16>y?0:"")+y.toString(16)}return i};',e})});var ie={};K(ie,{getLastResult:()=>B,init:()=>U});var E;try{E=P().sha256||P()}catch{E=window.sha256}var q=null,N="visitoriq_offline_queue";function W(){return`${window.screen.width}x${window.screen.height}`}function G(){return new Date().getTimezoneOffset()}function X(){try{return document.referrer||""}catch{return""}}function $(){return navigator.webdriver||!1}async function V(){if(navigator.storage&&navigator.storage.estimate)try{let e=await navigator.storage.estimate();if(e.quota&&e.quota<12e7)return!0}catch{}try{let e=window.indexedDB.open("test");return e.onerror=()=>!0,e.onsuccess=()=>{e.result.close(),window.indexedDB.deleteDatabase("test")},!1}catch{return!0}}function Y(e){return new Promise((t,i)=>{if(window.ThumbmarkJS)return t(window.ThumbmarkJS);let n=document.createElement("script");n.src=e||"https://cdn.jsdelivr.net/npm/thumbmarkjs@latest/dist/thumbmark.min.js",n.onload=()=>t(window.ThumbmarkJS),n.onerror=i,document.head.appendChild(n)})}function Z(){try{let e=document.createElement("canvas"),t=e.getContext("2d");return t.textBaseline="top",t.font="14px Arial",t.fillText(navigator.userAgent,2,2),E(e.toDataURL())}catch{return"canvas-fallback"}}async function ee(e){if(window.ThumbmarkJS&&window.ThumbmarkJS.getCanvasHash)try{return await window.ThumbmarkJS.getCanvasHash()}catch{}return e&&window.Fingerprint2?new Promise(t=>{window.Fingerprint2.get(i=>{let n=i.map(s=>s.value).join("");t(E(n))})}):Z()}function J(){try{return JSON.parse(localStorage.getItem(N)||"[]")}catch{return[]}}function R(e){localStorage.setItem(N,JSON.stringify(e))}async function te(e){let t=J();if(t.length){for(let i of t)try{await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})}catch{}R([])}}async function re(){if(!navigator.geolocation)return{permission:"denied"};try{let t=(await navigator.permissions?.query?.({name:"geolocation"}))?.state||"prompt";return new Promise(i=>{navigator.geolocation.getCurrentPosition(n=>i({lat:n.coords.latitude,lon:n.coords.longitude,accuracy:n.coords.accuracy,permission:"granted"}),n=>i({permission:n.code===1?"denied":"prompt"}),{enableHighAccuracy:!1,timeout:2e3,maximumAge:6e4})})}catch{return{permission:"denied"}}}function ne(){let e=[];return navigator.hardwareConcurrency&&navigator.hardwareConcurrency>16&&e.push("High hardware concurrency"),navigator.deviceMemory&&(navigator.deviceMemory>16||navigator.deviceMemory<1)&&e.push("Unusual device memory"),!("ontouchstart"in window)&&/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)&&e.push("No touch on mobile UA"),/emulator|sdk|simulator/i.test(navigator.userAgent)&&e.push("UA mentions emulator"),{isEmulator:e.length>0,reasons:e}}async function U({siteKey:e,endpoint:t,onResult:i,thumbmarkKey:n,fallbackEnabled:s,email:w,botd_result:l}){t=t||(window.NEXT_PUBLIC_SITE_URL?window.NEXT_PUBLIC_SITE_URL+"/api/collect-visitor":"/api/collect-visitor"),s=s??window.FINGERPRINT_FALLBACK_ENABLED==="true";let r=navigator.userAgent,c=navigator.language,y=Intl.DateTimeFormat().resolvedOptions().timeZone,m=G(),b=W(),o=X(),k=$(),S=await V(),A=await re(),g=ne();if(!window.ThumbmarkJS)try{await Y(n)}catch{}let h=await ee(!!s),p;try{window.ThumbmarkJS&&(p=await new window.ThumbmarkJS.Thumbmark().get())}catch{p=void 0}let O=p&&p.thumbmark?p.thumbmark:E(r+h+b+y);function T(a){let u="",f="";return/chrome|crios|crmo/i.test(a)?u="Chrome":/firefox|fxios/i.test(a)?u="Firefox":/safari/i.test(a)&&!/chrome|crios|crmo/i.test(a)?u="Safari":/edg/i.test(a)?u="Edge":/opr\//i.test(a)?u="Opera":/msie|trident/i.test(a)?u="IE":u=(a.split(" ")[0]||"").split("/")[0],/windows nt/i.test(a)?f="Windows":/android/i.test(a)?f="Android":/iphone|ipad|ipod/i.test(a)?f="iOS":/macintosh|mac os x/i.test(a)?f="Mac OS":/linux/i.test(a)?f="Linux":f="Unknown",{browser:u,os:f}}let{browser:x,os:v}=T(r),d={siteKey:e,fingerprint_hash:O,userAgent:r,language:c,timezone:y,timezoneOffset:m,resolution:b,referrer:o,incognito:S,webdriver:k,thumbmark_details:p||{},browser:x,os:v,geo:A,emulator:g};w&&(d.email=w),l&&(d.botd_result=l);try{console.log("VisitorIQ SDK payload",d),q=await(await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})).json(),i&&i(q),te(t)}catch{let u=J();u.push(d),R(u)}}function B(){return q}window.visitoriq={init:U,getLastResult:B};return z(ie);})();
//# sourceMappingURL=index.min.js.map